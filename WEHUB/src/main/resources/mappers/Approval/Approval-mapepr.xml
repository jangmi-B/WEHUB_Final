<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.kh.wehub.approval.model.dao.ApprovalDao">
	
	<resultMap type="Approval" id="approvalResultMap">
		<id property="appNo" column="APP_SEQ"/>
		<result property="appWriteDate" column="APP_WRITE_SYS"/>
		<result property="appWriterNo" column="APP_WRITER_NO"/>		
		<result property="firstApprover" column="FIRST_TIME_APPROVER"/>
		<result property="interimApprover" column="INTERIM_APPROVER"/>
		<result property="finalApprover" column="FINAL_APPROVER"/>
		<result property="appCheckSysdate" column="APP_CHECK_SYSDATE"/>
		<result property="appCheckProgress" column="APP_CHECK_PROGRESS"/>
		<result property="appReason" column="APP_REASON"/>
		<result property="appOriginalFileName" column="APP_ORIFILENAME"/>
		<result property="appRenameFileName" column="APP_REFILENAME"/>
		<result property="userNo" column="USER_NO"/>
		<result property="appKinds" column="APPROVAL_KINDS"/>
		<result property="userName" column="USER_NAME"/>
		<result property="rowNum" column="ROWNUM"/>
		<result property="deptName" column="DEPT_NAME"/>
		<result property="loaTitle" column="LOA_TITLE"/>
		<result property="loaContent" column="LOA_DETAIL"/>
		<result property="loaAppNo" column="LOA_APP_SEQ"/>
		<result property="receiveRefAppNo" column="RECEIVE_REF_APP_SEQ"/>
		<result property="referList" column="RECEIVE_REF_CC"/>
		<result property="rank" column="RANK"/>
		<result property="appPresent" column="APP_PRESENT"/>
		<!-- <collection property="app_loa" javaType="java.util.ArrayList" resultMap="app_loa"/> -->
	</resultMap>
	
	<!-- <resultMap type="App_Leave" id="leaveResultMap">
		<id property="leaveNo" column="LEAVE_SEQ"/>
		<result property="leaveAppNo" column="LEAVE_APP_SEQ"/>
		<result property="leaveClassify" column="LEAVE_CLASSIFY"/>
		<result property="leaveStart" column="LEAVE_START"/>
		<result property="leaveFinish" column="LEAVE_FINISH"/>
		<result property="leaveDetail" column="LEAVE_DETAIL"/>
		<result property="leaveStatus" column="LEAVE_STATUS"/>
		<result property="leavePreasent" column="LEAVE_PRESENT"/>
		<result property="appEmergncyCall" column="APP_EMERGENCYCALL"/>
	</resultMap>
	
 	<resultMap type="App_Receive_Ref" id="receiveResultMap">
		<id property="receiveRefNo" column="RECEIVE_REF_SEQ"/>
		<result property="refAppNo" column="RECEIVE_REF_APP_SEQ"/>
		<result property="receiveCc" column="RECEIVE_REF_CC"/>
	</resultMap>
	
	<resultMap type="APP_LOA" id="LOAResultMap">
		<id property="loaNo" column="LOA_SEQ"/>
		<result property="loaAppNo" column="LOA_APP_SEQ"/>
		<result property="loaTltle" column="LOA_TITLE"/>
		<result property="loaDetale" column="LOA_DETAIL"/>
		<result property="loaStatus" column="LOA_STATUS"/>
		<result property="loaPresent" column="LOA_PRESENT"/>
	</resultMap> -->

	
	<!-- insert Approval -->
 	<insert id="insertApproval" parameterType="map"
		useGeneratedKeys="true" keyProperty="appNo" keyColumn="APP_SEQ">
		INSERT INTO APPROVAL(
			APP_SEQ,
			APP_WRITE_SYS,
			FIRST_TIME_APPROVER,
			INTERIM_APPROVER,
			FINAL_APPROVER,
			APP_CHECK_SYSDATE,
			APP_REASON,
			APP_ORIFILENAME,
			APP_REFILENAME,
			APP_WRITER_NO,
			APP_CHECK_PROGRESS,
			APPROVAL_KINDS
		)
		VALUES(
			SEQ_APP_SEQ.NEXTVAL,
			SYSDATE,
			#{firstApprover},
			#{interimApprover},
			#{finalApprover},
			#{appCheckSysdate},
			#{appReason},
			#{appOriginalFileName},
			#{appRenameFileName},
			#{AppWriterNo},
			DEFAULT,
            #{approvalKinds}
		)
	</insert>
	
	<!-- insert Leave -->
	<insert id="insertAppLeave" parameterType="map"
		useGeneratedKeys="true" keyProperty="leaveNo" keyColumn="LEAVE_SEQ">
		INSERT INTO APP_LEAVE(
			LEAVE_SEQ,
			LEAVE_APP_SEQ,
			LEAVE_CLASSIFY,
			LEAVE_START,
			LEAVE_FINISH,
			LEAVE_DETAIL,
			LEAVE_STATUS,
			LEAVE_PRESENT,
			APP_EMERGENCYCALL
		)
		VALUES(
			SEQ_LEAVE_SEQ.NEXTVAL,
			#{leaveAppNo},
			#{leaveClassify},
			#{leaveStart},
			#{leaveFinish},
			#{leaveDetail},
			DEFAULT,
			DEFAULT,
			#{appEmergncyCall}
		)
	</insert>
	
	<!-- insert Receive -->
	<insert id="insertReceiveRef" parameterType="map"
		useGeneratedKeys="true" keyProperty="receiveRefNo" keyColumn="RECEIVE_REF_SEQ">
		INSERT INTO APP_RECEIVE_REF(
			RECEIVE_REF_SEQ,
			RECEIVE_REF_APP_SEQ,
			RECEIVE_REF_CC
		)
		VALUES(
			SEQ_RECEIVE_REF_SEQ.NEXTVAL,
			#{refAppNo},
			null
		)
	</insert>
	
	<!-- insert LOA -->
 	<insert id="insertLOA" parameterType="map"
		useGeneratedKeys="true" keyProperty="loaNo" keyColumn="LOA_SEQ">
		INSERT INTO APP_LOA (
			LOA_SEQ,
			LOA_APP_SEQ,
			LOA_TITLE,
			LOA_DETAIL,
			LOA_STATUS,
			LOA_PRESENT
		)
		VALUES(
			SEQ_LOA_SEQ.NEXTVAL,
			#{loaAppNo},
			#{loaTltle},
			#{loaDetale},
			DEFAULT,
			DEFAULT
		)
	</insert>
	
	<!-- insert App_ER -->
	<insert id="" parameterType="map"
		useGeneratedKeys="true" keyProperty="reNo" keyColumn="ER_SEQ">
		INSERT INTO APP_ER (
			ER_SEQ,
			ER_APP_SEQ,
			ER_DEADLINE,
			ER_CLASSIFY,
			ER_TITLE,
			ER_DETAIL,
			ER_AMOUNT,
			ER_REFERENCE,
			ER_STATUS,
			ER_PRESENT
		)
		VALUES(
			SEQ_ER_SEQ.NEXTVAL,
			#{reAppNo},
			#{reDeadline},
			#{reSlassify},
			#{trTitle},
			#{reDetail},
			#{reAmount},
			#{reReference},
			DEFAULT,
			DEFAULT
		)
	</insert>
	
</mapper>
